<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>MONITORING GFORM</title>

<!-- Libraries -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.3.2/papaparse.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>

<style>
/* -------------------------------------------------------
   GLOBAL & BACKGROUND
------------------------------------------------------- */
body {
  font-family: Arial, sans-serif;
  margin:0;
  background:#0a0a12;
  color:#eee;
  overflow:hidden;
}

/* -------------------------------------------------------
   MATRIX BACKGROUND
------------------------------------------------------- */
#matrixCanvas {
  position:fixed;
  top:0; left:0;
  width:100%;
  height:100%;
  z-index:-1;
  opacity:0.25;
}

/* -------------------------------------------------------
   GLITCH EFFECT
------------------------------------------------------- */
.glitch {
  position: relative;
  color: #0ff;
  font-weight: bold;
  animation: glitch 1.5s infinite;
  text-shadow: 0 0 5px #0ff;
}
@keyframes glitch {
  0% { text-shadow: 2px 0 red, -2px 0 blue; }
  20% { text-shadow: -2px 0 red, 2px 0 blue; }
  40% { text-shadow: 2px 0 red, -2px 0 blue; }
  60% { text-shadow: -2px 0 red, 2px 0 blue; }
  100% { text-shadow: 2px 0 red, -2px 0 blue; }
}

/* -------------------------------------------------------
   LOADER SCREEN
------------------------------------------------------- */
#loaderScreen {
  position:fixed;
  top:0; left:0; right:0; bottom:0;
  background:#02030a;
  display:flex;
  flex-direction:column;
  justify-content:center;
  align-items:center;
  z-index:99999;
  text-align:center;
}

/* spinner neon */
.spinner {
  width:60px;
  height:60px;
  border-radius:50%;
  border:5px solid #0ff;
  border-top-color:transparent;
  animation: spin 0.9s linear infinite, glow 1.5s infinite;
}
@keyframes spin {
  to { transform:rotate(360deg); }
}
@keyframes glow {
  0% { box-shadow:0 0 10px #0ff; }
  50% { box-shadow:0 0 25px #0ff; }
  100% { box-shadow:0 0 10px #0ff; }
}

.cyber-text {
  margin-top:22px;
  font-size:48px;
  color:#0ff;
  text-shadow:0 0 24px #0ff, 0 0 48px #0ff;
  animation: neonBlink 1.2s infinite;
}
.cyber-sub {
  margin-top:12px;
  font-size:24px;
  color:#f0f;
  text-shadow:0 0 15px #f0f, 0 0 25px #f0f;
}
@keyframes neonBlink {
  0% {opacity:1;}
  50% {opacity:0.4;}
  100% {opacity:1;}
}

/* -------------------------------------------------------
   PHOTO SCREEN
------------------------------------------------------- */
#photoScreen {
  position:fixed;
  top:0; left:0; right:0; bottom:0;
  background:#000;
  display:none;
  justify-content:center;
  flex-direction:column;
  align-items:center;
  z-index:99998;
}
#photoScreen img {
  width:1000px;
  border-radius:80px;
  box-shadow:0 0 125px #0ff;
}
.cyber-title {
  margin-top:14px;
  font-size:65px;
  font-weight:bold;
  color:#0ff;
  text-shadow:0 0 40px #0ff, 0 0 68px #0ff, 0 0 115px #0ff;
  animation: neonBlink 1.5s infinite;
}

/* -------------------------------------------------------
   HEADER
------------------------------------------------------- */
header {
  background:#1e5bb8;
  color:white;
  padding:15px;
  text-align:center;
  font-size:20px;
  font-weight:bold;
  position:fixed;
  top:0; left:0; right:0;
  z-index:1000;
}

.wrap { 
  padding:16px; 
  padding-top:90px; 
  display:none;
}

/* -------------------------------------------------------
   BUTTONS
------------------------------------------------------- */
.button-row {
  display:flex;
  gap:10px;
  margin-bottom:12px;
  position:fixed;
  top:60px; left:0; right:0;
  padding:0 16px;
  background:#0d0d14;
  z-index:999;
}
.btn {
  padding:8px 16px;
  border:none;
  border-radius:6px;
  background:#1e5bb8;
  color:white;
  cursor:pointer;
  font-weight:bold;
  transition:0.2s;
}
.btn.active { background:red; }
.btn:hover { transform:scale(1.08); }

/* by EL neon rgb */
.by-el {
  align-self:center;
  margin-left:5px;
  font-weight:bold;
  font-size:14px;
  background: linear-gradient(90deg,#f0f,#0ff,#0f0,#ff0,#f00);
  -webkit-background-clip:text;
  -webkit-text-fill-color:transparent;
  animation: rgbMove 2s infinite linear;
}
@keyframes rgbMove { 
  0% {filter:hue-rotate(0deg);}
  100% {filter:hue-rotate(360deg);}
}
.clock-time{
  font-size: 18px;
  letter-spacing: 2px;
  text-shadow: 0 0 6px #0ff;
}

.clock-date{
  font-size: 18px;
  text-shadow: 0 0 6px #0ff;
  opacity: 0.85;
}
/* -------------------------------------------------------
   WEEK BUTTONS
------------------------------------------------------- */
.week-row {
  display:flex;
  gap:8px;
  margin-bottom:12px;
  display:none;
  position:fixed;
  top:105px;
  left:0; right:0;
  padding:0 16px;
  background:#0d0d14;
  z-index:998;
}
.week-btn { padding:6px 12px; border:none; border-radius:6px; background:#666; color:white; cursor:pointer; font-weight:bold; transition: transform 0.2s ease, box-shadow 0.2s ease; }
.week-btn.active { background:red; }
.week-btn:hover { transform: translateY(-2px) scale(1.08); box-shadow:0 4px 12px rgba(0,0,0,0.15); }
/* -------------------------------------------------------
   DISPLAY & CARDS - GRADIENT PASTEL & GLOW PER TIPE
------------------------------------------------------- */
.card, .monthly-card {
  border-radius: 8px;
  padding: 6px;
  margin-bottom: 10px;
  transition: transform 0.3s, box-shadow 0.3s, background 0.3s;
  color: #000; /* teks hitam */
  box-shadow: 0 2px 6px rgba(0,0,0,0.2);
  background: linear-gradient(135deg, #fdf6e3, #e0f7fa); /* default gradient */
}

/* sudah input - gradient pastel hijau/blue */
.card.sudah, .monthly-card.sudah {
  background: linear-gradient(135deg, #d4edda, #a0e8af);
}

/* belum input - gradient pastel kuning/orange */
.card.belum, .monthly-card.belum {
  background: linear-gradient(135deg, #f8d7da, #ffe4b3);
}

/* hover efek mewah untuk semua */
.card:hover, .monthly-card:hover {
  transform: translateY(-5px) scale(1.02);
  box-shadow: 0 6px 20px rgba(0,0,0,0.35), 0 0 15px rgba(255,255,255,0.6);
  filter: brightness(1.05);
}

/* grid */
.week-grid {
  display: grid;
  grid-template-columns: repeat(7, minmax(0, 1fr));
  gap: 10px;
}

/* item */
.item {
  border-bottom: 1px solid rgba(0,0,0,0.15);
  padding: 6px 8px;
  font-size: 12px;
}
   
/* pastikan wrap dataDisplay scrollable tapi tetap di bawah header */
.wrap {
  padding-top: 150px; /* header + button-row + week-row total tinggi */
  padding-left: 16px;
  padding-right: 16px;
  display: none;
}

/* tetap scrollable */
#dataDisplay {
  overflow-y: auto;
  max-height: calc(100vh - 150px); /* sesuaikan sama padding-top */
  margin-top: 0; /* hapus margin-top lama */
  padding-bottom: 20px;
  position: relative; /* agar z-index bisa berfungsi */
  z-index: 1; /* di bawah header dan button */
}
#dataDisplay h3,
#dataDisplay .card {
  margin-top: 8px !important;
}




/* -------------------------------------------------------
   MATRIX FX SCRIPT AREA
------------------------------------------------------- */
</style>
</head>
<body>

<!-- MATRIX BACKGROUND -->
<canvas id="matrixCanvas"></canvas>

<!-- LOADER -->
<div id="loaderScreen">
  <div class="spinner"></div>
  <div class="cyber-text glitch">LOADING... PLEASE WAIT...!!</div>
  <div class="cyber-sub">Alloh bersama orang-orang yang sabar</div>
</div>

<!-- PHOTO SCREEN -->
<div id="photoScreen">
  <img src="https://raw.githubusercontent.com/monitorgform-max/monitoring-fix/main/upscalemedia-transformed.jpeg">
  <div class="cyber-title glitch">UG ARTA BATAM</div>
</div>

<header class="glitch">MONITORING GFORM</header>

<div class="wrap">

  <div class="button-row">
    <button class="btn" id="btnWeekly">Weekly</button>
    <button class="btn" id="btnMonthly">Monthly</button>
    <button class="btn" id="btnRefresh">Refresh</button>
    <div class="by-el">by EL</div>
    <div class="clock-time" id="clockTime">00 : 00 : 00</div>
    <div class="clock-date" id="clockDate">Senin, 1 Januari 2025</div>
  </div>

  <div class="week-row" id="weekButtons">
    <button class="week-btn" data-week="1">W1</button>
    <button class="week-btn" data-week="2">W2</button>
    <button class="week-btn" data-week="3">W3</button>
    <button class="week-btn" data-week="4">W4</button>
  </div>

  <div id="dataDisplay"></div>

</div>

<script>

/* -------------------------------------------------------
   MATRIX ANIMATION - CINEMATIC MULTI-LAYER NEON E&L
------------------------------------------------------- */
const canvas = document.getElementById("matrixCanvas");
const ctx = canvas.getContext("2d");

canvas.width = window.innerWidth;
canvas.height = window.innerHeight;

const letters = "E L";
const fontSize = 20;
const columns = Math.floor(canvas.width / fontSize);
const drops = Array(columns).fill(1);
let hue = 0;

function drawMatrix() {
  // 1. Background trail gelap tipis (tanpa shadow)
  ctx.shadowBlur = 0;
  ctx.fillStyle = "rgba(0,0,0,0.05)";
  ctx.fillRect(0, 0, canvas.width, canvas.height);

  // 2. Update warna huruf RGB neon
  hue = (hue + 1) % 360;
  const color = `hsl(${hue},100%,50%)`;
  
  // 3. Layer glow huruf (multi-layer)
  for (let i = 0; i < drops.length; i++) {
    const text = letters.charAt(Math.floor(Math.random() * letters.length));
    const x = i * fontSize;
    const y = drops[i] * fontSize;

    // Layer tipis glow
    ctx.fillStyle = color;
    ctx.shadowColor = color;
    ctx.shadowBlur = 6;
    ctx.fillText(text, x, y);

    // Layer medium glow
    ctx.shadowBlur = 14;
    ctx.fillText(text, x, y);

    // Layer tebal glow
    ctx.shadowBlur = 28;
    ctx.fillText(text, x, y);

    // Reset drop ke atas kalau sudah habis
    if (drops[i] * fontSize > canvas.height && Math.random() > 0.975) drops[i] = 0;

    // Turun pelan
    drops[i] += 0.4;
  }
}

setInterval(drawMatrix, 60);

window.addEventListener("resize", () => {
  canvas.width = window.innerWidth;
  canvas.height = window.innerHeight;
});

/* -------------------------------------------------------
   REALTIME CLOCK
------------------------------------------------------- */
function updateClock(){
  const now = new Date();

  const time = now.toLocaleTimeString("id-ID",{
    hour:"2-digit",
    minute:"2-digit",
    second:"2-digit",
    hour12:false
  }).replace(/\./g," : ");

  const date = now.toLocaleDateString("id-ID",{
    weekday:"long",
    day:"numeric",
    month:"long",
    year:"numeric"
  });

  const sec = now.getSeconds();
  const hue = sec * 6;

  const clockTime = document.getElementById("clockTime");
  clockTime.textContent = time;
  clockTime.style.color = `hsl(${hue},100%,50%)`;
  clockTime.style.textShadow = `0 0 8px hsl(${hue},100%,60%)`;

  document.getElementById("clockDate").textContent = date;
}

setInterval(updateClock,1000);
updateClock();
   
/* -------------------------------------------------------
   ORIGINAL SCRIPT TIDAK DIUBAH
------------------------------------------------------- */

/* === STATE === */
const btnWeekly=document.getElementById("btnWeekly");
const btnMonthly=document.getElementById("btnMonthly");
const btnRefresh=document.getElementById("btnRefresh");
const weekButtons=document.getElementById("weekButtons");
const weekBtns=document.querySelectorAll(".week-btn");
const dataDisplay=document.getElementById("dataDisplay");

function resetMainButtons(){[btnWeekly,btnMonthly,btnRefresh].forEach(b=>b.classList.remove("active"));}
function resetWeekButtons(){weekBtns.forEach(b=>b.classList.remove("active"));}

/* === URL ganti weekly sheet id dan monthly form url=== */
const MASTER_WEEKLY_CSV="Data Mesin.csv";
const MASTER_MONTHLY_CSV="Data Mesin Monthly.csv";

const WEEKLY_SHEET_ID = "1vu_dfnpIwRRPQHwpLTHZYadle6wIt1g2eBqRz2dVjPI";
const WEEKLY_SHEET_NAME = "Form Responses 1";
const WEEKLY_SHEET_URL = `https://opensheet.elk.sh/${WEEKLY_SHEET_ID}/${encodeURIComponent(WEEKLY_SHEET_NAME)}`;

const MONTHLY_FORM_URL = "https://opensheet.elk.sh/1otuxQaIYR57_01gXZkhngJkZ9HoIJRW08GyIfU2g7zg/Form%20Responses%201";

/* === DATA === */
let weeklyRows=[], monthlyRows=[], masterWeekly=[], masterMonthly=[];

function safe(v){return v==null?"":String(v).trim();}
async function loadCSV(url){return new Promise(resolve=>{Papa.parse(url,{download:true,header:true,skipEmptyLines:true,complete:r=>resolve(r.data),error:()=>resolve([])});});}

/* === LOAD ALL === */
async function loadAll(){
  masterWeekly=await loadCSV(MASTER_WEEKLY_CSV);
  masterMonthly=await loadCSV(MASTER_MONTHLY_CSV);
  weeklyRows=await fetch(WEEKLY_SHEET_URL).then(r=>r.json()).catch(()=>[]);
  monthlyRows=await fetch(MONTHLY_FORM_URL).then(r=>r.json()).catch(()=>[]);
}

/* === RENDER WEEKLY === */
function renderWeekly(weekNumber){
  const targetWeek=`Week ${weekNumber}`;
  const list=masterWeekly.filter(m=>safe(m.WEEK)===targetWeek);
  const sudahList=[], belumList=[];

  list.forEach(m=>{
    const id=safe(m["ID Mesin"]);
    const match=weeklyRows.find(r=>safe(r["ID Mesin"])===id && safe(r["WEEK"])===targetWeek);
    if(match) sudahList.push({...m,Timestamp:safe(match.Timestamp)});
    else belumList.push(m);
  });

  function chunkInto(arr,n=7){
    const out=Array.from({length:n},()=>[]);
    let idx=0,base=Math.floor(arr.length/n),rem=arr.length%n;
    for(let i=0;i<n;i++){
      const size=base+(i<rem?1:0);
      out[i]=arr.slice(idx,idx+size);
      idx+=size;
    }
    return out;
  }

  let html=`<h3>Sudah Input (${sudahList.length} mesin)</h3>`;
  const colSud=chunkInto(sudahList);

  html+=`<div class="week-grid">`+
  colSud.map(col=>`
    <div class="card sudah">
      ${col.map(m=>`
      <div class="item">
        <strong>${safe(m["ID Mesin"])}</strong> — ${safe(m.SEKTOR)}<br>
        ${safe(m["Nama Lokasi"])}<br>
        <small>${m.Timestamp}</small>
      </div>`).join("")}
    </div>`).join("")+`</div>`;

  html+=`<h3>Belum Input (${belumList.length} mesin)</h3>`;
  const colBel=chunkInto(belumList);

  html+=`<div class="week-grid">`+
  colBel.map(col=>`
    <div class="card belum">
      ${col.map(m=>`
      <div class="item">
        <strong>${safe(m["ID Mesin"])}</strong> — ${safe(m.SEKTOR)}<br>
        ${safe(m["Nama Lokasi"])}
      </div>`).join("")}
    </div>`).join("")+`</div>`;

  dataDisplay.innerHTML=html;
}

/* === RENDER MONTHLY === */
function renderMonthly(){
  const sudah=[], belum=[];
  masterMonthly.forEach(m=>{
    const id=safe(m["ID Mesin"]);
    const nama=safe(m["Nama Lokasi"])||"—";
    const sektor=safe(m.Sektor||m.SEKTOR)||"—";
    const match=monthlyRows.find(r=>safe(r["ID Mesin"])===id);
    if(match){
      let tsRaw=safe(match.Timestamp);
      let ts=tsRaw;
      const d=new Date(tsRaw);
      if(!isNaN(d)) ts=d.toLocaleString("id-ID",{hour12:false});
      sudah.push({id,nama,sektor,ts});
    } else belum.push({id,nama,sektor});
  });

  function chunk(arr,n=7){
    const out=Array.from({length:n},()=>[]);
    let idx=0,base=Math.floor(arr.length/n),rem=arr.length%n;
    for(let i=0;i<n;i++){
      const size=base+(i<rem?1:0);
      out[i]=arr.slice(idx,idx+size);
      idx+=size;
    }
    return out;
  }

  let html=`<h3>Sudah Input (${sudah.length} mesin)</h3>`;
  html+=`<div class="week-grid">`+
  chunk(sudah).map(col=>`
    <div class="monthly-card sudah">
      ${col.map(c=>`
      <div class="item">
        <strong>${c.id}</strong> — ${c.sektor}<br>
        ${c.nama}<br>
        <small>${c.ts}</small>
      </div>`).join("")}
    </div>`).join("")+`</div>`;

  html+=`<h3>Belum Input (${belum.length} mesin)</h3>`;
  html+=`<div class="week-grid">`+
  chunk(belum).map(col=>`
    <div class="monthly-card belum">
      ${col.map(c=>`
      <div class="item">
        <strong>${c.id}</strong> — ${c.sektor}<br>
        ${c.nama}
      </div>`).join("")}
    </div>`).join("")+`</div>`;

  dataDisplay.innerHTML=html;
}

btnMonthly.addEventListener("click",async()=>{
  resetMainButtons();
  btnMonthly.classList.add("active");
  weekButtons.style.display="none";
  dataDisplay.innerHTML="<div class='card'>Loading monthly data…</div>";
  masterMonthly=await loadCSV(MASTER_MONTHLY_CSV);
  monthlyRows=await fetch(MONTHLY_FORM_URL).then(r=>r.json()).catch(()=>[]);
  renderMonthly();
});

btnWeekly.addEventListener("click",async()=>{
  resetMainButtons();
  btnWeekly.classList.add("active");
  weekButtons.style.display="flex";
  dataDisplay.innerHTML="<div class='card'>Loading weekly data…</div>";
  resetWeekButtons();
  if(masterWeekly.length===0||weeklyRows.length===0) await loadAll();
  dataDisplay.innerHTML="<div class='card'>Pilih week untuk melihat data</div>";
});

weekBtns.forEach(b=>{
  b.addEventListener("click",async()=>{
    resetWeekButtons();
    b.classList.add("active");
    dataDisplay.innerHTML=`<div class='card'>Loading week ${b.dataset.week}…</div>`;
    if(masterWeekly.length===0||weeklyRows.length===0) await loadAll();
    renderWeekly(b.dataset.week);
  });
});

btnRefresh.addEventListener("click",async()=>{
  resetMainButtons();
  btnRefresh.classList.add("active");
  dataDisplay.innerHTML="<div class='card'>Refresh…</div>";
  await loadAll();
  dataDisplay.innerHTML="<div class='card'>Data terbaru sudah dimuat.</div>";
});

/* -------------------------------------------------------
   LOADING SEQUENCE
------------------------------------------------------- */
loadAll();

setTimeout(()=>{
  document.getElementById("loaderScreen").style.display="none";
  document.getElementById("photoScreen").style.display="flex";

  setTimeout(()=>{
    document.getElementById("photoScreen").style.display="none";
    document.querySelector(".wrap").style.display="block";
  }, 7000);

}, 5000);

</script>

</body>
</html>






































